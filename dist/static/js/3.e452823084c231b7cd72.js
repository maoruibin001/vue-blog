(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{346:function(t,e,a){"use strict";var s=a(91);a.n(s).a},347:function(t,e,a){},348:function(t,e,a){"use strict";var s=a(92);a.n(s).a},349:function(t,e,a){},350:function(t,e,a){t.exports={default:a(351),__esModule:!0}},351:function(t,e,a){var s=a(12),i=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},352:function(t,e,a){"use strict";var s=a(93);a.n(s).a},353:function(t,e,a){},359:function(t,e,a){"use strict";a.r(e);var s=a(1),i=a.n(s),n=a(10),o=a.n(n),r=a(103),c=a.n(r),l=a(3),m=a(350),d=a.n(m),u={data:function(){return{name:"",address:"",content:"",imgName:"",summitFlag:!1,activeIndex:1}},created:function(){this.getAllComments({aid:this.$route.params.id}),localStorage.token&&this.user.name?this.imgName="me":this.imgName="reviewer",localStorage.reviewer&&(this.address=localStorage["e-mail"],this.name=localStorage.reviewer)},computed:i()({},Object(l.e)(["comments","user"]),{likeArr:function(){if(localStorage.getItem(this.$route.params.id)){var t=localStorage.getItem(this.$route.params.id);return JSON.parse(t)}return[]}}),methods:i()({},Object(l.b)(["summitComment","getAllComments","updateLike","deleteComment"]),Object(l.d)(["set_dialog","set_comments"]),{sort:function(t,e){var a=1<arguments.length&&void 0!==e?e:1;this.activeIndex=a;var s="";switch(a){case 1:case 2:s="date";break;case 3:s="like"}var i=this.comments.concat([]);i.sort(function(e,a){return t*(a[s]-e[s])}),this.set_comments(i)},summit:function(){var t=this;if(this.name&&this.content)if(/^[\w_-]+@[\w_-]+\.[\w\\.]+$/.test(this.address)){if(500<this.content.length)return this.set_dialog({info:"您的评论内容太长，要言简意赅哦",hasTwoBtn:!1,show:!0}),!1;if(this.content.length<5)return this.set_dialog({info:"您的评论内容太短，说多一点嘛",hasTwoBtn:!1,show:!0}),!1;if(/\d{7,}/i.test(this.content)||/(\d.*){7,}/i.test(this.content)||/\u52A0.*\u7FA4/i.test(this.content)||/(\u9876.*){5,}/i.test(this.content)||/([\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D\u25CB\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396\u96F6].*){7,}/i.test(this.content))return this.set_dialog({info:"请不要发表灌水、广告、违法、Q群Q号等信息，感谢您的配合！",hasTwoBtn:!1,show:!0}),!1;this.summitFlag=!0,localStorage.setItem("e-mail",this.address),localStorage.setItem("reviewer",this.name),this.summitComment({imgName:this.imgName,name:this.name,content:this.content,address:this.address,aid:+this.$route.params.id,curPath:this.$route.fullPath}).then(function(){t.content="",t.summitFlag=!1,t.getAllComments({aid:t.$route.params.id})}).catch(function(e){t.set_dialog({info:e.body,hasTwoBtn:!1,show:!0}),t.summitFlag=!1,t.name=""})}else this.set_dialog({info:"请正确填写邮箱地址",hasTwoBtn:!1,show:!0});else this.set_dialog({info:"还有选项没填(⊙o⊙)？",hasTwoBtn:!1,show:!0})},reply:function(t){this.content="@"+t+": ",this.$refs.textBox.focus()},removeComment:function(t,e,a){var s=this;this.deleteComment({aid:t,cid:e,address:a}).then(function(){s.getAllComments({aid:s.$route.params.id})})},addLike:function(t,e,a,s){var i=this,n=this.likeArr.indexOf(e);-1===n?this.updateLike({aid:t,cid:e,addLike:1}).then(function(){i.likeArr.push(e),i.getAllComments({aid:i.$route.params.id}),localStorage[i.$route.params.id]=d()(i.likeArr)}).catch(function(t){console.log(t)}):this.updateLike({aid:t,cid:e,addLike:0}).then(function(){i.likeArr.splice(n,1),i.getAllComments({aid:i.$route.params.id}),localStorage[i.$route.params.id]=d()(i.likeArr)}).catch(function(t){console.log(t)})}}),watch:{$route:function(t,e){"#article"===t.hash&&(this.content=""),this.getAllComments({aid:t.params.id})}}},h=(a(348),a(2)),p=Object(h.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"comment"}},[a("div",{staticClass:"newComment"},[a("img",{attrs:{src:"../../../../static/"+t.imgName+".jpg"}}),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],ref:"textBox",attrs:{id:"reply",spellcheck:"false",placeholder:"说点什么吧..."},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),a("div",{staticClass:"inputBox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.address,expression:"address"}],attrs:{type:"text",placeholder:"邮箱 (用于通知)"},domProps:{value:t.address},on:{input:function(e){e.target.composing||(t.address=e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"name",attrs:{id:"nameBox",type:"text",placeholder:"称呼"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" "),a("button",{attrs:{disabled:t.summitFlag},on:{click:t.summit}},[a("span",[t._v(t._s(t.summitFlag?"提交中...":"发布评论"))])])])]),t._v(" "),a("div",{staticClass:"allComments"},[a("div",{staticClass:"summary"},[a("p",[t._v("评论数 "+t._s(t.comments.length))]),t._v(" "),a("p",[a("span",{class:1===t.activeIndex?["active"]:"",on:{click:function(e){t.sort(-1,1)}}},[t._v("\n                最早\n              ")]),t._v("|\n                "),a("span",{class:2===t.activeIndex?["active"]:"",on:{click:function(e){t.sort(1,2)}}},[t._v("\n                最新\n              ")]),t._v("|\n                "),a("span",{class:3===t.activeIndex?["active"]:"",on:{click:function(e){t.sort(1,3)}}},[t._v("\n                最热\n              ")])])]),t._v(" "),t._l(t.comments,function(e,s){return a("div",{key:s,staticClass:"comments"},[a("div",{class:e.imgName,attrs:{id:"info"}},[a("p",{staticClass:"commentName"},[t._v("\n                    #"+t._s(s+1)+" "),a("span",[t._v(t._s(e.name))])]),t._v(" "),a("p",{staticClass:"text"},[t._v("\n                    "+t._s(e.content)+"\n                ")]),t._v(" "),a("div",{staticClass:"options"},[a("p",{staticClass:"commentDate"},[t._v("\n                        "+t._s(t._f("to_date")(e.date))+"\n                    ")]),t._v(" "),a("a",{attrs:{href:"#comment","data-scroll":""}},[a("span",{on:{click:function(a){t.reply(e.name)}}},[a("i",{staticClass:"iconfont icon-huifu"}),t._v("回复\n                  ")])]),t._v(" "),a("p",{on:{click:function(a){t.addLike(e.aid,e.cid,s,e.like)}}},[a("i",{staticClass:"iconfont icon-like",class:{activeLike:-1!==t.likeArr.indexOf(e.cid)}}),t._v(" "+t._s(e.like)+"\n                    ")])]),t._v(" "),a("img",{attrs:{src:"../../../../static/"+e.imgName+".jpg"}})])])}),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:0===t.comments.length,expression:"comments.length === 0"}],staticClass:"nocomment"},[t._v("\n            哎，没人理我 :(\n        ")])],2)])},[],!1,null,"5a65230d",null).exports,v={data:function(){return{showList:!1}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){window.removeEventListener("scroll",this.handleScroll)},computed:i()({},Object(l.c)(["articleList"])),methods:{handleScroll:function(){if("article"===this.$route.name){var t=document.getElementById("list"),e=document.getElementById("nav").clientHeight;window.scrollY>e?(t.style.position="fixed",t.style.top=0):(t.style.position="absolute",t.style.top="40px")}},scrollBorder:function(t){this.$refs.emptyBox.style.top=t.target.offsetTop+"px",this.$refs.emptyBox.style.height=t.target.clientHeight+"px"}},watch:{$route:function(t,e){"article"===t.name&&"#article"===t.hash&&(this.$refs.emptyBox.style.top="2rem")},articleList:function(t){t&&0<t.length&&(this.showList=!0)}}},g=(a(352),Object(h.a)(v,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"list"}},[a("i",{directives:[{name:"show",rawName:"v-show",value:!t.showList,expression:"!showList"}],staticClass:"iconfont icon-mulu",on:{click:function(e){t.showList=!0}}}),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],staticClass:"iconfont icon-icon13",on:{click:function(e){t.showList=!1}}}),t._v(" "),a("transition-group",{attrs:{id:"showCata","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",tag:"div"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],key:"empty",ref:"emptyBox",staticStyle:{top:"2rem",height:"1.875rem"},attrs:{id:"empty"}}),t._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],key:"summary",staticClass:"summary"},[t._v("\n            文章目录\n        ")]),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],key:"catalog",staticClass:"catalog"},t._l(t.articleList,function(e,s){return a("li",{key:s,class:"level-"+e.level,on:{click:t.scrollBorder}},[a("a",{attrs:{href:"#"+e.content,"data-scroll":""}},[t._v("\n                "+t._s(e.content)+"\n              ")])])}),0)])],1)},[],!1,null,"01b52074",null).exports);o.a.setOptions({highlight:function(t){return c.a.highlightAuto(t).value},sanitize:!0});var f=new o.a.Renderer;f.heading=function(t,e){return'<a href="#'+t+'" class="hashTitle" data-scroll><h'+e+' id="'+t+'">'+t+"</h"+e+"></a>"};var _={data:function(){return{prePage:0,nextPage:0,count:0,showTab:!0}},created:function(){window.addEventListener("scroll",this.handleScroll),this.getArticle(this.$route.params.id),this.initPage()},beforeRouteUpdate:function(t,e,a){this.getArticle(t.params.id),0===t.params.index?(this.prePage=-1,this.nextPage=1):t.params.index===this.articles.length-1?(this.prePage=t.params.index-1,this.getAllArticles({tag:this.curTag,add:!0,page:++t.params.page}),this.nextPage=t.params.index+1):(t.hash&&"#article"!==t.hash&&(t.params.page=e.params.page,t.params.index=e.params.index),this.prePage=t.params.index-1,this.nextPage=parseInt(t.params.index)+1),a()},computed:i()({},Object(l.e)(["articles","curTag","article"]),{mdHtml:function(){return o()(this.article.content||"",{renderer:f})}}),methods:i()({},Object(l.b)(["getArticle","getAllArticles"]),{mark:o.a,handleScroll:function(){var t=document.querySelector(".content .comment").getBoundingClientRect();this.showTab=100<t.top},initPage:function(){var t=this.$route.params.index-0,e=this.$route.params.page-0||1;0==t?(this.prePage=-1,this.nextPage=1):(t==this.articles.length-1?(this.prePage=t-1,this.getAllArticles({tag:this.curTag,add:!0,page:++e})):this.prePage=t-1,this.nextPage=1+t)}}),components:{ArticleComment:p,ArticleList:g}},w=(a(346),Object(h.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper",attrs:{id:"article"}},[a("div",{attrs:{id:"content"}},[a("h1",{staticClass:"title animated fadeIn"},[t._v("\n            "+t._s(t.article.title)+"\n        ")]),t._v(" "),a("div",{staticClass:"appendInfo animated fadeIn"},[a("time",[a("i",{staticClass:"iconfont icon-shijian"}),t._v(t._s(t._f("toDate")(t.article.date))+"\n            ")]),t._v(" "),a("span",[a("i",{staticClass:"iconfont icon-label"}),t._v(t._s(t._f("toTag")(t.article.tags))+"\n            ")]),t._v(" "),a("a",{staticClass:"commentCount",attrs:{href:"#comment"}},[a("i",{staticClass:"iconfont icon-huifu"}),t._v(t._s(t.article.comment_n)+"\n            ")])]),t._v(" "),t.showTab?a("article-list",{staticClass:"list animated fadeIn"}):t._e(),t._v(" "),a("div",{staticClass:"content animated fadeIn",domProps:{innerHTML:t._s(t.mdHtml)}}),t._v(" "),a("div",{staticClass:"indexes animated fadeIn"},[a("div",{staticClass:"last animated fadeIn"},[t.articles[t.prePage]?a("router-link",{staticClass:"left",attrs:{to:{name:"article",params:{id:t.articles[t.prePage].aid,index:t.prePage,page:t.$route.params.page},hash:"#article"},tag:"p"}},[a("i",{staticClass:"iconfont icon-left"}),t._v(t._s(t.articles[t.prePage].title)+"\n                ")]):t._e(),t._v(" "),t.articles[t.nextPage]?a("router-link",{staticClass:"right",attrs:{to:{name:"article",params:{id:t.articles[t.nextPage].aid,index:t.nextPage,page:t.$route.params.page},hash:"#article"},tag:"p"}},[t._v("\n                    "+t._s(t.articles[t.nextPage].title)),a("i",{staticClass:"iconfont icon-right"})]):t._e()],1)]),t._v(" "),a("article-comment",{staticClass:"comment animated fadeIn"})],1),t._v(" "),a("router-link",{staticClass:"iconfont icon-fanhui",attrs:{to:{name:"articles"},tag:"i"}})],1)},[],!1,null,"39ead3da",null));e.default=w.exports},91:function(t,e,a){var s=a(347);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals),(0,a(4).default)("75552388",s,!0,{})},92:function(t,e,a){var s=a(349);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals),(0,a(4).default)("261dae9e",s,!0,{})},93:function(t,e,a){var s=a(353);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals),(0,a(4).default)("3675cc10",s,!0,{})}}]);