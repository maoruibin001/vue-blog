(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{152:function(t,e,n){"use strict";var i=n(87);n.n(i).a},153:function(t,e,n){},340:function(t,e,n){"use strict";var i=n(88);n.n(i).a},341:function(t,e,n){},360:function(t,e,n){"use strict";n.r(e);var i=n(74),s=n.n(i),a=n(1),o=n.n(a),c=n(10),r=n.n(c),u=n(103),l=n.n(u),d=n(3),h={props:{tags:Array,index:Number},data:function(){return{show:!0}},methods:o()({},Object(d.d)(["set_dialog"]),{delTag:function(){this.tags.splice(this.index,1)},addTag:function(){var t=this;this.tags.push(""),setTimeout(function(){document.getElementsByClassName("newInput")[t.index+1].focus()},0)},isRepeated:function(){var t=this.index,e=this.tags[t];if(e)for(;t;){if(e.toLowerCase()===this.tags[t-1].toLowerCase()){this.set_dialog({info:"傻了吧，标签不能重复",hasTwoBtn:!1,show:!0}),this.tags.splice(this.index,1,"");break}t--}}}),computed:{tagContent:{get:function(){return this.tags[this.index]},set:function(t){this.tags[this.index]=t.trim()}}}},f=(n(340),n(2)),g=Object(f.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"tag_div"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.tagContent,expression:"tagContent"}],staticClass:"newInput",attrs:{type:"text",placeholder:"标签",onfocus:"this.placeholder=''"},domProps:{value:t.tagContent},on:{blur:t.isRepeated,keydown:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addTag(e):null},input:function(e){e.target.composing||(t.tagContent=e.target.value)}}}),t._v(" "),1<t.tags.length?n("i",{staticClass:"iconfont icon-shanchu1",on:{click:t.delTag}}):t._e(),t._v(" "),t.index===t.tags.length-1?n("i",{staticClass:"iconfont icon-zengjia",on:{click:t.addTag}}):t._e()]):t._e()},[],!1,null,"959d16b6",null).exports;r.a.setOptions({highlight:function(t){return l.a.highlightAuto(t).value},sanitize:!0});var p=new r.a.Renderer;p.heading=function(t,e){return'<a href="#'+t+'" class="hashTitle" data-scroll><h'+e+' id="'+t+'">'+t+"</h"+e+"></a>"};var v={directives:{focus:{inserted:function(t){t.focus()}}},data:function(){return{isMarked:!0,firstUpdate:!0,isChange:!1,mdHtml:""}},created:function(){var t=this.$route.query.aid;if(this.isSaving_toggle(!1),t)return this.getArticle(t);this.set_article({content:"",title:"",tags:[""]})},mounted:function(){var t=this;document.addEventListener("keydown",function(e){40===e.keyCode&&e.ctrlKey&&(t.isMarked=!t.isMarked)}),this.mdContent=this.article.content},updated:function(){this.firstUpdate&&(this.isChange=!1),this.firstUpdate=!1},computed:o()({},Object(d.e)(["article","isSaving","dialog"]),{mdContent:{get:function(){return this.mdHtml=r()(this.article.content||"",{renderer:p}),this.article.content},set:function(t){this.update_post_content(t)}},title:{get:function(){return this.article.title||""},set:function(t){this.update_post_title(t)}},tags:function(){return this.article.tags}}),methods:o()({},Object(d.d)(["set_article","update_post_content","update_post_title","update_post_tags","isSaving_toggle","set_dialog"]),Object(d.b)(["saveArticle","getArticle","saveDraft"])),components:{TagInput:g},watch:{title:function(){this.isChange=!0},tags:function(){this.isChange=!0},mdContent:function(t){this.mdHtml=r()(this.article.content||"",{renderer:p}),this.isChange=!0,this.update_post_content(t),setTimeout(function(){document.getElementById("editor").focus()},0)}},beforeRouteLeave:function(t,e,n){var i=this;this.isChange&&!this.isSaving?(this.set_dialog({info:"还没保存，确认离开(⊙o⊙)？",hasTwoBtn:!0,show:!0}),new s.a(function(t,e){i.dialog.resolveFn=t,i.dialog.rejectFn=e}).then(function(){n()},function(){n(!1)}).catch(function(t){console.log(t)})):n()}},m=(n(152),Object(f.a)(v,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"title"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",placeholder:"文章标题",onfocus:"this.placeholder=''",onblur:"this.placeholder='文章标题'"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),n("div",{attrs:{id:"tags"}},t._l(t.tags,function(e,i){return n("tag-input",{key:i,attrs:{tags:t.tags,index:i}})}),1),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"right"},[n("p",{class:{active:t.isMarked},on:{click:function(e){t.isMarked=!0}}},[t._v("\n                原文\n            ")]),t._v(" "),n("p",{class:{active:!t.isMarked},on:{click:function(e){t.isMarked=!1}}},[t._v("\n                预览\n            ")])]),t._v(" "),t.isMarked?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mdContent,expression:"mdContent"},{name:"focus",rawName:"v-focus"}],attrs:{id:"editor",spellcheck:"false"},domProps:{value:t.mdContent},on:{"~keydown":function(e){return("button"in e||13===e.keyCode)&&e.ctrlKey?void t.saveDraft(t.$route.query.aid):null},input:function(e){e.target.composing||(t.mdContent=e.target.value)}}}):t._e(),t._v(" "),t.isMarked?t._e():n("div",{directives:[{name:"focus",rawName:"v-focus"}],staticClass:"preview animated fadeIn",attrs:{tabIndex:"1"},domProps:{innerHTML:t._s(t.mdHtml)}})]),t._v(" "),n("button",{staticClass:"draft",on:{click:function(e){t.saveDraft(t.$route.query.aid)}}},[n("span",[t._v("存为草稿")])]),t._v(" "),n("button",{staticClass:"publish",on:{click:function(e){t.saveArticle(t.$route.query.aid)}}},[n("span",[t._v("发布文章")])])])},[],!1,null,"a258836c",null));e.default=m.exports},87:function(t,e,n){var i=n(153);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,n(4).default)("d41a21c0",i,!0,{})},88:function(t,e,n){var i=n(341);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,n(4).default)("30415ac6",i,!0,{})}}]);